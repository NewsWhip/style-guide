<h1 class="page-header">NewsWhip Style Guide</h1>

<p>Angular version: {{version.full}}</p>

<button class="btn btn-md btn-primary" (click)="zoomOut()">Zoom out</button>

<div class="scatterplot-container">
    <svg nw-chart
        style="width: 700px; height: 700px; display: block;"
        [margins]="chartMargins"
        [class.has-active-group]="activeGroup"
        [ngClass]="zoomedQuadrant ? 'zoomed-quadrant-' + zoomedQuadrant.id : null"
        (mouseleave)="onChartMouseleave()">
    
        <g *ngFor="let q of quadrants"
            class="quadrant nw-slot-2"
            [ngClass]="q.id"
            [class.active]="q.id === hoveredQuadrant?.id"
            [class.zoomed]="q.id === zoomedQuadrant?.id"
            (mouseenter)="onQuadrantMouseenter(q)"
            (click)="toggleQuadrantZoom(q)">
            <path
                [nw-area]="q.area"
                [xDomain]="xDomain"
                [yDomain]="yDomain"
                [xScale]="axisScale"
                [animDuration]="animDuration"></path>

            <text class="quadrant-label" *ngFor="let label of q.labels; let index = index"
                [ngClass]="label.className"
                [nw-text]="label.point"
                [xDomain]="xDomain"
                [yDomain]="yDomain"
                [xScale]="axisScale"
                [animDuration]="animDuration"
                [attr.text-anchor]="label.textAnchor"
                [attr.dy]="15 * index">{{label.value}}</text>
        </g>

        <g *ngFor="let label of axisLabels">
            <text class="axis-label"
                [nw-text]="label.point"
                [xDomain]="xDomain"
                [yDomain]="yDomain"
                [xScale]="axisScale"
                [animDuration]="animDuration"
                [attr.text-anchor]="label.textAnchor"
                [style.translate]="label.translate">
                <tspan x="0" class="metric-value">{{label.value}}</tspan>
                <tspan x="0" dy="1.2em" class="metric-label">{{label.label}}</tspan>
            </text>
        </g>

        <path class="nw-slot-2 x axis"
            [nw-path]="[[xDomain[0], center.y], [xDomain[1], center.y]]"
            [xDomain]="xDomain"
            [yDomain]="yDomain"
            [xScale]="axisScale"
            [animDuration]="animDuration"
            stroke="white"
            stroke-width="1px"></path>

        <path class="nw-slot-2 y axis"
            [nw-path]="[[center.x, yDomain[1]], [center.x, yDomain[0]]]"
            [xDomain]="xDomain"
            [yDomain]="yDomain"
            [xScale]="axisScale"
            [animDuration]="animDuration"
            stroke="white"
            stroke-width="1px"></path>

        <ng-container *ngFor="let group of groupedEntities">
            <ng-container *ngTemplateOutlet="entityGroupTmpl; context: { group }"></ng-container>
        </ng-container>

        <ng-template #entityGroupTmpl let-group="group">
            <g class="entity-group"
                (mouseenter)="onGroupMouseenter(group)"
                (mouseleave)="onGroupMouseleave()"
                [class.active]="group === activeGroup">
                <circle
                    [nw-circle]="[group.x, group.y]"
                    [xDomain]="xDomain"
                    [yDomain]="yDomain"
                    [animDuration]="animDuration"
                    [xScale]="axisScale"
                    r=4
                    fill="#3D81FF"></circle>
        
                <text class="entity-label-group"
                    [nw-text]="[group.x, group.y]"
                    [xDomain]="xDomain"
                    [yDomain]="yDomain"
                    [xScale]="axisScale"
                    [animDuration]="animDuration"
                    [attr.text-anchor]="group.positionDetails.textAnchor"
                    [style.translate]="group.translate">
                    <tspan *ngFor="let entity of group.entities | slice:0:(group === activeGroup ? Infinity : maxEntitiesToDisplay); let index = index"
                        x="0"
                        [attr.dx]="group.positionDetails.dx"
                        [attr.dy]="group.positionDetails.dy"
                        class="entity-label">{{entity.name}}</tspan>
        
                    <tspan *ngIf="group !== activeGroup && group.entities.length > maxEntitiesToDisplay"
                        x="0"
                        [attr.dx]="group.positionDetails.dx"
                        [attr.dy]="group.positionDetails.dy">+ {{group.entities.length - maxEntitiesToDisplay}} more</tspan>
                </text>
            </g>
        </ng-template>
    </svg>
</div>